<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coronavirus Tracker</title>
    <link href="style.css" rel="stylesheet">
</head>
<body>

    <!--
        To do:
            1. Add positive/tested side by side
            2. Filter by state
            3. Add dropdown for alternate sources - JHU, other?
            4. Add day-over-day change

    -->
    <div class="wrapper">
        <div class="header"><h2>Covid19 Tracker</h2></div>
    
        <div class="content">
        <table id="dataTable">
        <caption>Number of positive cases</caption>
        <thead id="tableHead"></thead>
        <tbody id="tableBody"></tbody>
        </table>
        
        </div>
        <div class="sidebar">
         <div class="dropdown">
            <button class="dropbtn">Source</button>
            <ul id="sourceDropdown" class="dropdown-content">
                <li onclick="sortOrder=false; loadTable(sortState(dataSet))">Covidtracking.com</li>
                <li onclick="sortOrder=false; loadJhu(sortState(jhuUS))">JHU</li>

            </ul>

            <!--
            <button onclick="toggleMenu()"  class="dropbtn">Metric</button>
            <ul id="myDropdown" class="dropdown-content">
                <li onclick="setMetric('positive'); loadTable(dataSet)">Confirmed</li>
                <li onclick="setMetric('death'); loadTable(dataSet, 'death')">Deaths</li>
                <li onclick="setMetric('total'); loadTable(dataSet, 'total')">Tested</li>
            </ul>
        -->
            

        </div> 
        
        </div>
        <div class="footer">Source of data:<a href="https://covidtracking.com/"> https://covidtracking.com/</a></div>
        
        
    </div>


    <script type="text/javascript" src="helpers.js"></script>

    <script>

    

    var dataSet;
    var rawData;
    var jhuData;
    var jhuUS;
    var metric = "positive";
    var jhuHeaders;
    var url = "https://covidtracking.com/api/states/daily";
    var url1 = "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv";
    
    var sortOrder = false;
    fetch(url)
        .then(function (response) {
            return response.json();
        }).then(function(data) {
            rawData = data;
            cols_all = [...new Set(rawData.map(x=>x.date)) ].sort();
            cols = cols_all.slice(-7);
            dataSet = formatdata(data); 
            loadTable(sortState(dataSet));
        });

    fetch(url1)
        .then(function (response) {
            return response.text();
        }).then(function(data) {
            jhuData = toJSON(data).filter(a => +a['3/17/20'] > 0);
            jhuUS = jhuData.filter(a => a.country == 'US');
        });
            


    </script>



    
</body>
</html>